<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª - Skillzoy</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script>
        // ØªÙƒÙˆÙŠÙ† Tailwind Ù…Ø³Ø¨Ù‚Ø§Ù‹
        tailwind.config = {
            darkMode: 'class',
        }
    </script>
    <style>
        body {
            font-family: 'Tajawal', sans-serif;
        }
        
        /* Ø´Ø±ÙŠØ· Ø­Ø§Ù„Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª */
        .db-status-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            z-index: 1000;
        }
        
        .db-status-connected {
            background: linear-gradient(90deg, #10b981, #34d399);
        }
        
        .db-status-disconnected {
            background: linear-gradient(90deg, #ef4444, #f87171);
        }
        
        .db-status-text {
            position: fixed;
            top: 6px;
            left: 10px;
            z-index: 1001;
            font-size: 10px;
            font-weight: 600;
            padding: 2px 6px;
            border-radius: 4px;
        }
        
        .db-status-text-connected {
            background: #10b981;
            color: white;
        }
        
        .db-status-text-disconnected {
            background: #ef4444;
            color: white;
        }

        /* ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª Ø§Ù„Ù…Ù…ØªØ¯Ø© */
        .notification-expanded {
            max-width: 500px;
            width: 90%;
        }

        /* Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        .loading-spinner-dark {
            border: 3px solid rgba(0,0,0,.1);
            border-top-color: #000;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ù„Ù„Ø¨Ø·Ø§Ù‚Ø§Øª */
        .loading-card {
            position: relative;
            overflow: hidden;
        }

        .loading-card::after {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            bottom: 0;
            left: 0;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
        .btn-disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .btn-loading {
            position: relative;
            color: transparent !important;
        }

        .btn-loading::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            width: 20px;
            height: 20px;
            margin: -10px 0 0 -10px;
            border: 2px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø¸Ù‡ÙˆØ± */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ØªØ£Ø«ÙŠØ±Ø§Øª Ø§Ù„Ø§Ù‡ØªØ²Ø§Ø² Ù„Ù„Ø®Ø·Ø£ */
        .shake {
            animation: shake 0.5s ease-in-out;
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
    </style>
</head>
<body class="bg-gray-50 dark:bg-gray-900 min-h-screen transition-colors duration-300">
    <!-- Ø´Ø±ÙŠØ· Ø­Ø§Ù„Ø© Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
    <div id="dbStatusBar" class="db-status-bar db-status-disconnected"></div>
    <div id="dbStatusText" class="db-status-text db-status-text-disconnected">
        <i class="fas fa-database mr-1"></i>
        <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</span>
    </div>

    <!-- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ -->
    <header class="bg-white dark:bg-gray-800 shadow-sm sticky top-2 z-40 mx-4 mt-6 rounded-lg">
        <div class="max-w-7xl mx-auto px-4 py-4">
            <div class="flex justify-between items-center">
                <div class="flex items-center space-x-4 space-x-reverse">
                    <div class="bg-blue-500 rounded-lg w-10 h-10 flex items-center justify-center text-white">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-gray-800 dark:text-white">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª</h1>
                        <p class="text-sm text-gray-500 dark:text-gray-400">Skillzoy Academy</p>
                    </div>
                </div>
                
                <div class="flex items-center space-x-3 space-x-reverse">
                    <div id="connectionStatus" class="hidden md:flex items-center bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 px-3 py-1 rounded-full text-sm">
                        <i class="fas fa-circle animate-pulse mr-1 text-red-500"></i>
                        <span>Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„...</span>
                    </div>
                    
                    <button id="themeToggle" class="p-2 rounded-full text-gray-500 dark:text-gray-300 hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors">
                        <i class="fas fa-moon"></i>
                    </button>
                    
                    <a href="index.html" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center transition-colors">
                        <i class="fas fa-arrow-left ml-2"></i>
                        <span class="hidden sm:inline">Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ÙˆÙ‚Ø¹</span>
                    </a>
                </div>
            </div>
        </div>
    </header>

    <!-- Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ -->
    <main class="max-w-7xl mx-auto px-4 py-6">
        <!-- Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-blue-100 dark:bg-blue-900/30 text-blue-500">
                        <i class="fas fa-book text-lg"></i>
                    </div>
                    <div class="mr-3">
                        <p class="text-sm text-gray-500 dark:text-gray-400">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¯ÙˆØ±Ø§Øª</p>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="totalCourses">0</h3>
                    </div>
                </div>
            </div>
            
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-green-100 dark:bg-green-900/30 text-green-500">
                        <i class="fas fa-check-circle text-lg"></i>
                    </div>
                    <div class="mr-3">
                        <p class="text-sm text-gray-500 dark:text-gray-400">Ø¯ÙˆØ±Ø§Øª Ù†Ø´Ø·Ø©</p>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="activeCourses">0</h3>
                    </div>
                </div>
            </div>
            
            <div class="bg-white dark:bg-gray-800 rounded-lg shadow p-4">
                <div class="flex items-center">
                    <div class="p-3 rounded-full bg-purple-100 dark:bg-purple-900/30 text-purple-500">
                        <i class="fas fa-star text-lg"></i>
                    </div>
                    <div class="mr-3">
                        <p class="text-sm text-gray-500 dark:text-gray-400">Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</p>
                        <h3 class="text-xl font-bold text-gray-800 dark:text-white" id="averageRating">0/5</h3>
                    </div>
                </div>
            </div>
        </div>

        <!-- Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø© Ù…Ø¹ Ø²Ø± Ø§Ù„Ø¥Ø¶Ø§ÙØ© -->
        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4 mb-6">
            <div>
                <h2 class="text-2xl font-bold text-gray-800 dark:text-white">Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„Ù…ØªØ§Ø­Ø©</h2>
                <p class="text-gray-600 dark:text-gray-400 mt-1">Ø¥Ø¯Ø§Ø±Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ¹Ù„ÙŠÙ…ÙŠØ© ÙÙŠ Ù…Ù†ØµØªÙƒ</p>
            </div>
            
            <button id="addCourseBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center transition-colors w-full sm:w-auto justify-center">
                <i class="fas fa-plus ml-2"></i>
                Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
            </button>
        </div>

        <!-- Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ø¯ÙˆØ±Ø§Øª -->
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden">
            <!-- Ù…Ø¤Ø´Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø© -->
            <div id="listLoading" class="hidden p-8 text-center">
                <div class="loading-spinner loading-spinner-dark mx-auto mb-4"></div>
                <p class="text-gray-500 dark:text-gray-400">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø§Øª...</p>
            </div>
            
            <div id="coursesList" class="divide-y divide-gray-200 dark:divide-gray-700">
                <!-- Ø³ÙŠØªÙ… Ù…Ù„Ø¤Ù‡Ø§ Ø¨Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª -->
            </div>
            
            <!-- Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¯ÙˆØ±Ø§Øª -->
            <div id="emptyState" class="hidden p-8 text-center">
                <i class="fas fa-book-open text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-lg font-medium text-gray-700 dark:text-gray-300">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¯ÙˆØ±Ø§Øª</h3>
                <p class="text-gray-500 dark:text-gray-400 mt-1 mb-4">Ø§Ø¨Ø¯Ø£ Ø¨Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø¯ÙˆØ±Ø© ØªØ¹Ù„ÙŠÙ…ÙŠØ© Ø¥Ù„Ù‰ Ù…Ù†ØµØªÙƒ</p>
                <button id="addFirstCourseBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors">
                    Ø¥Ø¶Ø§ÙØ© Ø£ÙˆÙ„ Ø¯ÙˆØ±Ø©
                </button>
            </div>
        </div>
    </main>

    <!-- Ù†Ø§ÙØ°Ø© Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø© -->
    <div id="courseModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden p-4">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center p-4 sm:p-6 border-b border-gray-200 dark:border-gray-700">
                <h3 id="modalTitle" class="text-xl font-bold text-gray-800 dark:text-white">Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©</h3>
                <button id="closeModal" class="text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            
            <form id="courseForm" class="p-4 sm:p-6 space-y-4">
                <input type="hidden" id="courseId">
                
                <div class="grid grid-cols-1 gap-4">
                    <div>
                        <label for="courseTitle" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø© *</label>
                        <input type="text" id="courseTitle" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Ø£Ø¯Ø®Ù„ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø©">
                    </div>
                    
                    <div>
                        <label for="courseCategory" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø§Ù„ØªØµÙ†ÙŠÙ *</label>
                        <input type="text" id="courseCategory" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Ù…Ø«Ø§Ù„: Ø¨Ø±Ù…Ø¬Ø©ØŒ ØªØµÙ…ÙŠÙ…ØŒ Ø¥Ù„Ø®">
                    </div>
                </div>
                
                <div>
                    <label for="courseDescription" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">ÙˆØµÙ Ø§Ù„Ø¯ÙˆØ±Ø©</label>
                    <textarea id="courseDescription" rows="3" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="ÙˆØµÙ Ù…Ø®ØªØµØ± Ø¹Ù† Ø§Ù„Ø¯ÙˆØ±Ø©"></textarea>
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="courseDuration" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø§Ù„Ù…Ø¯Ø© *</label>
                        <input type="text" id="courseDuration" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Ù…Ø«Ø§Ù„: 35 Ø³Ø§Ø¹Ø©">
                    </div>
                    
                    <div>
                        <label for="courseLevel" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø§Ù„Ù…Ø³ØªÙˆÙ‰ *</label>
                        <select id="courseLevel" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white">
                            <option value="Ù…Ø¨ØªØ¯Ø¦">Ù…Ø¨ØªØ¯Ø¦</option>
                            <option value="Ù…ØªÙˆØ³Ø·">Ù…ØªÙˆØ³Ø·</option>
                            <option value="Ù…ØªÙ‚Ø¯Ù…">Ù…ØªÙ‚Ø¯Ù…</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <label for="playlistId" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ù…Ø¹Ø±Ù Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ (YouTube) *</label>
                    <input type="text" id="playlistId" required class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="PL590L5WQmH8d68VyR6RjhgldHMxMJ5B5z">
                </div>
                
                <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <div>
                        <label for="courseRating" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø§Ù„ØªÙ‚ÙŠÙŠÙ… (Ù…Ù† 1 Ø¥Ù„Ù‰ 5)</label>
                        <input type="text" id="courseRating" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Ù…Ø«Ø§Ù„: 4.8">
                        <p class="text-xs text-gray-500 mt-1">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø£Ø±Ù‚Ø§Ù… Ø§Ù„Ø¹Ø´Ø±ÙŠØ© Ù…Ø«Ù„ 4.8 Ø£Ùˆ 3.5</p>
                    </div>
                    
                    <div>
                        <label for="courseStudents" class="block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1">Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø§Ø¨</label>
                        <input type="text" id="courseStudents" class="w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-blue-500 focus:border-blue-500 dark:bg-gray-700 dark:text-white" placeholder="Ù…Ø«Ø§Ù„: 23,355">
                        <p class="text-xs text-gray-500 mt-1">ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ÙÙˆØ§ØµÙ„ Ù„ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø£Ø±Ù‚Ø§Ù…</p>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 space-x-reverse pt-4">
                    <button type="button" id="cancelBtn" class="px-4 py-2 border border-gray-300 dark:border-gray-600 text-gray-700 dark:text-gray-300 rounded-lg hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors order-2 sm:order-1">
                        Ø¥Ù„ØºØ§Ø¡
                    </button>
                    <button type="submit" id="saveCourseBtn" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded-lg transition-colors flex items-center justify-center order-1 sm:order-2">
                        <i class="fas fa-save ml-2"></i>
                        Ø­ÙØ¸ Ø§Ù„Ø¯ÙˆØ±Ø©
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø§Ù…Ø© -->
    <div id="globalLoading" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
        <div class="bg-white dark:bg-gray-800 rounded-lg shadow-xl p-6 flex flex-col items-center">
            <div class="loading-spinner loading-spinner-dark w-12 h-12 mb-4"></div>
            <p class="text-gray-700 dark:text-gray-300" id="loadingMessage">Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...</p>
        </div>
    </div>

    <script>
        // ğŸ”§ ØªÙƒÙˆÙŠÙ† Supabase
async   const SUPABASE_URL = 'https://sjipwstkvvrautexigmt.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNqaXB3c3RrdnZyYXV0ZXhpZ210Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTE5MDcsImV4cCI6MjA3NDQ4NzkwN30.FSh2yIdZdvdNvtWxK5JB02PIdWOG3707qO-F0c84PnY';
        

        let supabase;
        let isConnected = false;
        
        // ØªÙ‡ÙŠØ¦Ø© Supabase ÙˆÙØ­Øµ Ø§Ù„Ø§ØªØµØ§Ù„
        async function initializeSupabase() {
            try {
                if (SUPABASE_URL && SUPABASE_ANON_KEY && SUPABASE_URL !== 'https://your-project.supabase.co') {
                    supabase = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
                    
                    // Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø§ØªØµØ§Ù„
                    const { data, error } = await supabase
                        .from('courses')
                        .select('id')
                        .limit(1);
                    
                    if (error) throw error;
                    
                    // Ø§Ù„Ø§ØªØµØ§Ù„ Ù†Ø§Ø¬Ø­
                    isConnected = true;
                    updateConnectionStatus(true);
                    console.log('âœ… Connected to Supabase successfully');
                    
                } else {
                    throw new Error('Supabase not configured');
                }
            } catch (error) {
                // Ø§Ù„Ø§ØªØµØ§Ù„ ÙØ§Ø´Ù„
                isConnected = false;
                updateConnectionStatus(false);
                console.error('âŒ Failed to connect to Supabase:', error);
            }
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø§ØªØµØ§Ù„ ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø©
        function updateConnectionStatus(connected) {
            const dbStatusBar = document.getElementById('dbStatusBar');
            const dbStatusText = document.getElementById('dbStatusText');
            const connectionStatus = document.getElementById('connectionStatus');
            
            if (connected) {
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠ
                dbStatusBar.className = 'db-status-bar db-status-connected';
                dbStatusText.className = 'db-status-text db-status-text-connected';
                dbStatusText.innerHTML = '<i class="fas fa-database mr-1"></i><span>Ù…ØªØµÙ„ Ø¨Ù†Ø¬Ø§Ø­ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>';
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ
                connectionStatus.className = 'hidden md:flex items-center bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300 px-3 py-1 rounded-full text-sm';
                connectionStatus.innerHTML = '<i class="fas fa-circle mr-1 text-green-500"></i><span>Ù…ØªØµÙ„</span>';
                
            } else {
                // ØªØ­Ø¯ÙŠØ« Ø´Ø±ÙŠØ· Ø§Ù„Ø­Ø§Ù„Ø© Ø§Ù„Ø¹Ù„ÙˆÙŠ
                dbStatusBar.className = 'db-status-bar db-status-disconnected';
                dbStatusText.className = 'db-status-text db-status-text-disconnected';
                dbStatusText.innerHTML = '<i class="fas fa-database mr-1"></i><span>ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</span>';
                
                // ØªØ­Ø¯ÙŠØ« Ø´Ø§Ø±Ø© Ø§Ù„Ø­Ø§Ù„Ø© ÙÙŠ Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¹Ù„ÙˆÙŠ
                connectionStatus.className = 'hidden md:flex items-center bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300 px-3 py-1 rounded-full text-sm';
                connectionStatus.innerHTML = '<i class="fas fa-circle animate-pulse mr-1 text-red-500"></i><span>ØºÙŠØ± Ù…ØªØµÙ„</span>';
            }
        }
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙˆØ±Ø§Øª
        let courses = [];
        
        // Ø¹Ù†Ø§ØµØ± DOM
        const coursesList = document.getElementById('coursesList');
        const emptyState = document.getElementById('emptyState');
        const listLoading = document.getElementById('listLoading');
        const courseModal = document.getElementById('courseModal');
        const courseForm = document.getElementById('courseForm');
        const modalTitle = document.getElementById('modalTitle');
        const addCourseBtn = document.getElementById('addCourseBtn');
        const addFirstCourseBtn = document.getElementById('addFirstCourseBtn');
        const closeModal = document.getElementById('closeModal');
        const cancelBtn = document.getElementById('cancelBtn');
        const saveCourseBtn = document.getElementById('saveCourseBtn');
        const themeToggle = document.getElementById('themeToggle');
        const totalCoursesEl = document.getElementById('totalCourses');
        const activeCoursesEl = document.getElementById('activeCourses');
        const averageRatingEl = document.getElementById('averageRating');
        const globalLoading = document.getElementById('globalLoading');
        const loadingMessage = document.getElementById('loadingMessage');
        
        // ØªÙ‡ÙŠØ¦Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        document.addEventListener('DOMContentLoaded', async () => {
            await initializeSupabase();
            await loadCourses();
            setupEventListeners();
            
            // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ù…Ø© Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©
            const savedTheme = localStorage.getItem('theme');
            if (savedTheme === 'dark') {
                document.documentElement.classList.add('dark');
                themeToggle.innerHTML = '<i class="fas fa-sun"></i>';
            } else {
                document.documentElement.classList.remove('dark');
                themeToggle.innerHTML = '<i class="fas fa-moon"></i>';
            }
        });
        
        // Ø¥Ø¯Ø§Ø±Ø© Ø­Ø§Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„
        function setLoadingState(element, isLoading, text = '') {
            if (isLoading) {
                element.classList.add('btn-loading');
                element.disabled = true;
                if (text) {
                    element.setAttribute('data-original-text', element.innerHTML);
                    element.innerHTML = text;
                }
            } else {
                element.classList.remove('btn-loading');
                element.disabled = false;
                if (text && element.getAttribute('data-original-text')) {
                    element.innerHTML = element.getAttribute('data-original-text');
                }
            }
        }
        
        // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ø§Ù…
        function showGlobalLoading(message = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©...') {
            loadingMessage.textContent = message;
            globalLoading.classList.remove('hidden');
        }
        
        function hideGlobalLoading() {
            globalLoading.classList.add('hidden');
        }
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ù…Ù† Supabase
        async function loadCourses() {
            try {
                listLoading.classList.remove('hidden');
                coursesList.classList.add('hidden');
                emptyState.classList.add('hidden');
                
                if (isConnected && supabase) {
                    const { data, error } = await supabase
                        .from('courses')
                        .select('*')
                        .order('created_at', { ascending: false });
                    
                    if (error) throw error;
                    
                    courses = data || [];
                } else {
                    // Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙÙŠ Ø­Ø§Ù„Ø© Ø¹Ø¯Ù… Ø§Ù„Ø§ØªØµØ§Ù„
                    courses = JSON.parse(localStorage.getItem('skillzoyCourses')) || [];
                }
                
                renderCourses();
                updateStats();
                
            } catch (error) {
                console.error('Error loading courses:', error);
                courses = JSON.parse(localStorage.getItem('skillzoyCourses')) || [];
                renderCourses();
                updateStats();
            } finally {
                listLoading.classList.add('hidden');
                coursesList.classList.remove('hidden');
            }
        }
        
        // Ø­ÙØ¸ Ø§Ù„Ø¯ÙˆØ±Ø§Øª
        async function saveCourses() {
            try {
                if (isConnected && supabase) {
                    // Ø³ÙŠØªÙ… Ø§Ù„Ø­ÙØ¸ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ÙÙŠ Supabase Ø¹Ù†Ø¯ Ø¥Ø¶Ø§ÙØ©/ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø©
                } else {
                    // Ø§Ù„Ø­ÙØ¸ ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
                    localStorage.setItem('skillzoyCourses', JSON.stringify(courses));
                }
            } catch (error) {
                console.error('Error saving courses:', error);
            }
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø±Ù‚Ù… (ÙŠØ¯Ø¹Ù… Ø§Ù„ÙÙˆØ§ØµÙ„)
        function parseNumberWithCommas(text) {
            if (!text || text.trim() === '') return null;
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„ÙÙˆØ§ØµÙ„ ÙˆØªØ­ÙˆÙŠÙ„ Ø§Ù„Ù†Øµ Ø¥Ù„Ù‰ Ø±Ù‚Ù…
            const cleaned = text.toString().replace(/,/g, '');
            const number = parseFloat(cleaned);
            return isNaN(number) ? null : number;
        }
        
        // ØªØ­ÙˆÙŠÙ„ Ù†Øµ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… Ø¥Ù„Ù‰ Ø±Ù‚Ù… Ø¹Ø´Ø±ÙŠ
        function parseRating(text) {
            if (!text || text.trim() === '') return null;
            
            // Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„ÙØ§ØµÙ„Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ© Ø£Ùˆ Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ø¨Ù†Ù‚Ø·Ø©
            const cleaned = text.toString().replace(/ØŒ/g, '.').replace(/,/g, '.');
            const number = parseFloat(cleaned);
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø£Ù† Ø§Ù„Ø±Ù‚Ù… Ø¨ÙŠÙ† 1 Ùˆ 5
            if (isNaN(number) || number < 1 || number > 5) {
                return null;
            }
            
            return Math.round(number * 10) / 10; // ØªÙ‚Ø±ÙŠØ¨ Ø¥Ù„Ù‰ Ù…Ù†Ø²Ù„Ø© Ø¹Ø´Ø±ÙŠØ© ÙˆØ§Ø­Ø¯Ø©
        }
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„Ø±Ù‚Ù… Ù…Ø¹ ÙÙˆØ§ØµÙ„
        function formatNumberWithCommas(number) {
            if (!number && number !== 0) return '';
            return number.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }
        
        // ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… - Ø¥ØµÙ„Ø§Ø­ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ù‡Ù†Ø§
        function formatRating(rating) {
            if (!rating && rating !== 0) return '';
            // Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø£Ù† rating Ù‡Ùˆ Ø±Ù‚Ù… Ù‚Ø¨Ù„ Ø§Ø³ØªØ¯Ø¹Ø§Ø¡ toFixed
            const numRating = parseFloat(rating);
            return isNaN(numRating) ? '' : numRating.toFixed(1);
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù‚Ø¨Ù„ Ø§Ù„Ø­ÙØ¸
        function validateCourseData(courseData) {
            const errors = [];
            
            if (!courseData.title || courseData.title.trim() === '') {
                errors.push('Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨');
            }
            
            if (!courseData.category || courseData.category.trim() === '') {
                errors.push('ØªØµÙ†ÙŠÙ Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨');
            }
            
            if (!courseData.duration || courseData.duration.trim() === '') {
                errors.push('Ù…Ø¯Ø© Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨Ø©');
            }
            
            if (!courseData.level || courseData.level.trim() === '') {
                errors.push('Ù…Ø³ØªÙˆÙ‰ Ø§Ù„Ø¯ÙˆØ±Ø© Ù…Ø·Ù„ÙˆØ¨');
            }
            
            if (!courseData.playlist_id || courseData.playlist_id.trim() === '') {
                errors.push('Ù…Ø¹Ø±Ù Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„ØªØ´ØºÙŠÙ„ Ù…Ø·Ù„ÙˆØ¨');
            }
            
            if (courseData.rating !== null && (courseData.rating < 1 || courseData.rating > 5)) {
                errors.push('Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ÙŠÙ† 1 Ùˆ 5');
            }
            
            return errors;
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙˆØ±Ø§Øª ÙÙŠ Ø§Ù„Ù‚Ø§Ø¦Ù…Ø©
        function renderCourses() {
            if (courses.length === 0) {
                coursesList.innerHTML = '';
                emptyState.classList.remove('hidden');
                return;
            }
            
            emptyState.classList.add('hidden');
            
            coursesList.innerHTML = courses.map(course => `
                <div class="p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors fade-in">
                    <div class="flex flex-col sm:flex-row sm:items-center justify-between gap-3">
                        <div class="flex-1">
                            <div class="flex items-start space-x-3 space-x-reverse">
                                <div class="flex-shrink-0 w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center text-white mt-1">
                                    <i class="fas fa-book"></i>
                                </div>
                                <div class="flex-1 min-w-0">
                                    <h3 class="text-lg font-medium text-gray-800 dark:text-white truncate">${course.title}</h3>
                                    <p class="text-gray-500 dark:text-gray-400 text-sm mt-1 line-clamp-2">${course.description || 'Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØµÙ'}</p>
                                    <div class="flex flex-wrap gap-2 mt-2">
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200">
                                            ${course.category}
                                        </span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200">
                                            ${course.duration}
                                        </span>
                                        <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200">
                                            ${course.level}
                                        </span>
                                        ${course.rating ? `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200">
                                            <i class="fas fa-star text-yellow-500 ml-1"></i> ${formatRating(course.rating)}
                                        </span>` : ''}
                                        ${course.students ? `<span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200">
                                            ${formatNumberWithCommas(course.students)} Ø·Ø§Ù„Ø¨
                                        </span>` : ''}
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="flex space-x-2 space-x-reverse sm:self-start">
                            <button onclick="editCourse(${course.id})" class="text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 p-2 rounded-lg hover:bg-blue-50 dark:hover:bg-blue-900/30 transition-colors">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button onclick="deleteCourse(${course.id})" class="text-red-600 hover:text-red-800 dark:text-red-400 dark:hover:text-red-300 p-2 rounded-lg hover:bg-red-50 dark:hover:bg-red-900/30 transition-colors">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        function updateStats() {
            totalCoursesEl.textContent = courses.length;
            activeCoursesEl.textContent = courses.length;
            
            // Ø­Ø³Ø§Ø¨ Ù…ØªÙˆØ³Ø· Ø§Ù„ØªÙ‚ÙŠÙŠÙ…
            const ratings = courses
                .filter(course => course.rating)
                .map(course => course.rating);
            
            if (ratings.length > 0) {
                const average = ratings.reduce((sum, rating) => sum + rating, 0) / ratings.length;
                averageRatingEl.textContent = `${formatRating(average)}/5`;
            } else {
                averageRatingEl.textContent = '0/5';
            }
        }
        
        // Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©
        async function addCourse(courseData) {
            try {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const validationErrors = validateCourseData(courseData);
                if (validationErrors.length > 0) {
                    throw new Error(validationErrors.join(', '));
                }
                
                const newCourse = {
                    ...courseData,
                    id: Date.now(), // ID Ù…Ø¤Ù‚Øª
                    created_at: new Date().toISOString(),
                    provider: "Skillzoy Academy"
                };
                
                if (isConnected && supabase) {
                    const { data, error } = await supabase
                        .from('courses')
                        .insert([newCourse])
                        .select();
                    
                    if (error) throw error;
                    
                    courses.unshift(data[0]);
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    courseModal.classList.add('hidden');
                } else {
                    courses.unshift(newCourse);
                    await saveCourses();
                    showNotification('ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ù„ÙŠØ§Ù‹)', 'info');
                    courseModal.classList.add('hidden');
                }
                
                renderCourses();
                updateStats();
                
            } catch (error) {
                console.error('Error adding course:', error);
                showNotification(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø©: ${getErrorMessage(error)}`, 'error', true);
                // Ù„Ø§ Ù†ØºÙ„Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù†Ø¯ Ø§Ù„ÙØ´Ù„
                return false;
            }
            return true;
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¯ÙˆØ±Ø©
        async function updateCourse(courseId, courseData) {
            try {
                // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØµØ­Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const validationErrors = validateCourseData(courseData);
                if (validationErrors.length > 0) {
                    throw new Error(validationErrors.join(', '));
                }
                
                if (isConnected && supabase) {
                    const { error } = await supabase
                        .from('courses')
                        .update(courseData)
                        .eq('id', courseId);
                    
                    if (error) throw error;
                    
                    const index = courses.findIndex(c => c.id === courseId);
                    if (index !== -1) {
                        courses[index] = { ...courses[index], ...courseData };
                    }
                    
                    showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                    courseModal.classList.add('hidden');
                } else {
                    const index = courses.findIndex(c => c.id === courseId);
                    if (index !== -1) {
                        courses[index] = { ...courses[index], ...courseData };
                        await saveCourses();
                        showNotification('ØªÙ… ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ù„ÙŠØ§Ù‹)', 'info');
                        courseModal.classList.add('hidden');
                    }
                }
                
                renderCourses();
                
            } catch (error) {
                console.error('Error updating course:', error);
                showNotification(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¯ÙˆØ±Ø©: ${getErrorMessage(error)}`, 'error', true);
                // Ù„Ø§ Ù†ØºÙ„Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù†Ø¯ Ø§Ù„ÙØ´Ù„
                return false;
            }
            return true;
        }
        
        // Ø­Ø°Ù Ø¯ÙˆØ±Ø©
        async function deleteCourse(courseId) {
            if (!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ù‡ Ø§Ù„Ø¯ÙˆØ±Ø©ØŸ')) return;
            
            try {
                showGlobalLoading('Ø¬Ø§Ø±ÙŠ Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø©...');
                
                if (isConnected && supabase) {
                    const { error } = await supabase
                        .from('courses')
                        .delete()
                        .eq('id', courseId);
                    
                    if (error) throw error;
                    
                    courses = courses.filter(c => c.id !== courseId);
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­', 'success');
                } else {
                    courses = courses.filter(c => c.id !== courseId);
                    await saveCourses();
                    showNotification('ØªÙ… Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­ (Ù…Ø­Ù„ÙŠØ§Ù‹)', 'info');
                }
                
                renderCourses();
                updateStats();
                
            } catch (error) {
                console.error('Error deleting course:', error);
                showNotification(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ Ø­Ø°Ù Ø§Ù„Ø¯ÙˆØ±Ø©: ${getErrorMessage(error)}`, 'error', true);
            } finally {
                hideGlobalLoading();
            }
        }
        
        // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ Ù…Ù† ÙƒØ§Ø¦Ù† Ø§Ù„Ø®Ø·Ø£
        function getErrorMessage(error) {
            if (!error) return 'Ø®Ø·Ø£ ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
            
            // Ø®Ø·Ø£ Supabase
            if (error.message) return error.message;
            
            // Ø®Ø·Ø£ Ø´Ø¨ÙƒØ©
            if (error.name === 'TypeError' && error.message.includes('Failed to fetch')) {
                return 'ÙØ´Ù„ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª';
            }
            
            return error.toString();
        }
        
        // ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø©
        function openAddCourseModal() {
            modalTitle.textContent = 'Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø© Ø¬Ø¯ÙŠØ¯Ø©';
            courseForm.reset();
            document.getElementById('courseId').value = '';
            courseModal.classList.remove('hidden');
        }
        
        // ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ ØªØ¹Ø¯ÙŠÙ„ Ø¯ÙˆØ±Ø©
        function editCourse(courseId) {
            const course = courses.find(c => c.id === courseId);
            if (!course) return;
            
            modalTitle.textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø¯ÙˆØ±Ø©';
            document.getElementById('courseId').value = course.id;
            document.getElementById('courseTitle').value = course.title;
            document.getElementById('courseCategory').value = course.category;
            document.getElementById('courseDescription').value = course.description || '';
            document.getElementById('courseDuration').value = course.duration;
            document.getElementById('courseLevel').value = course.level;
            document.getElementById('playlistId').value = course.playlist_id;
            document.getElementById('courseRating').value = formatRating(course.rating) || '';
            document.getElementById('courseStudents').value = formatNumberWithCommas(course.students) || '';
            
            courseModal.classList.remove('hidden');
        }
        
        // Ø¥Ø¹Ø¯Ø§Ø¯ Ù…Ø³ØªÙ…Ø¹ÙŠ Ø§Ù„Ø£Ø­Ø¯Ø§Ø«
        function setupEventListeners() {
            // ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù…Ø©
            themeToggle.addEventListener('click', () => {
                const isDark = document.documentElement.classList.toggle('dark');
                localStorage.setItem('theme', isDark ? 'dark' : 'light');
                themeToggle.innerHTML = isDark ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
            });
            
            // ÙØªØ­ Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø¶Ø§ÙØ© Ø¯ÙˆØ±Ø©
            addCourseBtn.addEventListener('click', openAddCourseModal);
            addFirstCourseBtn.addEventListener('click', openAddCourseModal);
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            closeModal.addEventListener('click', () => courseModal.classList.add('hidden'));
            cancelBtn.addEventListener('click', () => courseModal.classList.add('hidden'));
            
            // Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¹Ù†Ø¯ Ø§Ù„Ù†Ù‚Ø± Ø®Ø§Ø±Ø¬ Ø§Ù„Ù…Ø­ØªÙˆÙ‰
            courseModal.addEventListener('click', (e) => {
                if (e.target.id === 'courseModal') {
                    courseModal.classList.add('hidden');
                }
            });
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬
            courseForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                
                const courseId = document.getElementById('courseId').value;
                const courseData = {
                    title: document.getElementById('courseTitle').value,
                    category: document.getElementById('courseCategory').value,
                    description: document.getElementById('courseDescription').value,
                    duration: document.getElementById('courseDuration').value,
                    level: document.getElementById('courseLevel').value,
                    playlist_id: document.getElementById('playlistId').value,
                    rating: parseRating(document.getElementById('courseRating').value),
                    students: parseNumberWithCommas(document.getElementById('courseStudents').value),
                    provider: "Skillzoy Academy"
                };
                
                // ØªØ¹Ø·ÙŠÙ„ Ø§Ù„Ø²Ø± ÙˆØ¥Ø¸Ù‡Ø§Ø± Ù…Ø¤Ø´Ø± Ø§Ù„ØªØ­Ù…ÙŠÙ„
                setLoadingState(saveCourseBtn, true, 'Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­ÙØ¸...');
                
                let success = false;
                if (courseId) {
                    success = await updateCourse(parseInt(courseId), courseData);
                } else {
                    success = await addCourse(courseData);
                }
                
                // Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…ÙƒÙŠÙ† Ø§Ù„Ø²Ø±
                setLoadingState(saveCourseBtn, false);
                
                // ÙÙ‚Ø· Ù†ØºÙ„Ù‚ Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ Ø¥Ø°Ø§ ÙƒØ§Ù†Øª Ø§Ù„Ø¹Ù…Ù„ÙŠØ© Ù†Ø§Ø¬Ø­Ø©
                if (success) {
                    courseModal.classList.add('hidden');
                }
            });
        }
        
        // Ø¹Ø±Ø¶ Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
        function showNotification(message, type = 'info', expanded = false) {
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±
            const notification = document.createElement('div');
            
            const bgColor = type === 'success' ? 'bg-green-500' : 
                           type === 'error' ? 'bg-red-500' : 
                           'bg-blue-500';
            
            const expandedClass = expanded ? 'notification-expanded' : 'max-w-sm';
            
            notification.className = `${bgColor} text-white px-4 py-3 rounded-lg shadow-lg flex items-center justify-between ${expandedClass} fixed top-20 left-4 z-50 transform transition-transform duration-300 translate-x-0 fade-in`;
            notification.innerHTML = `
                <div class="flex items-center flex-1">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-triangle' : 'info-circle'} mr-2 flex-shrink-0"></i>
                    <span class="flex-1">${message}</span>
                </div>
                <button class="ml-4 text-white hover:text-gray-200 flex-shrink-0" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            document.body.appendChild(notification);
            
            // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¥Ø´Ø¹Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ 5 Ø«ÙˆØ§Ù†ÙŠ
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 5000);
        }
    </script>
    <script>
// =========================
// Hacking  Protection v1.2
// =========================

(function () {
  const SETTINGS = {
    checkInterval: 1000,
    pauseThreshold: 200,
    widthDiffThreshold: 160,
    requiredDetections: 2,
    sensitiveSelector: ".sensitive",
    notifyEndpoint: "/api/devtools-detected"
  };

  let detections = {
    imageGetter: false,
    dimensionDiff: false,
    intervalPause: false,
    consoleTamper: false
  };

  let lastTick = performance.now();
  let detected = false;

  
  document.addEventListener("contextmenu", (e) => e.preventDefault(), { passive: false });
  document.addEventListener("copy", (e) => e.preventDefault(), { passive: false });
  document.addEventListener("cut", (e) => e.preventDefault(), { passive: false });
  document.addEventListener("selectstart", (e) => e.preventDefault(), { passive: false });

  
  document.addEventListener("keydown", (e) => {
    if (
      e.key === "F12" ||
      (e.ctrlKey && e.shiftKey && (e.key === "I" || e.key === "J")) ||
      (e.ctrlKey && e.key === "U")
    ) {
      e.preventDefault();
    }
  });

  // Ø·Ø±ÙŠÙ‚Ø© 1: image getter detection
  (function imageGetter() {
    const img = new Image();
    Object.defineProperty(img, "id", {
      get: function () {
        detections.imageGetter = true;
      }
    });
    console.log("%c", img);
  })();

  // Ø·Ø±ÙŠÙ‚Ø© 2: ÙØ±Ù‚ Ø§Ù„Ø£Ø¨Ø¹Ø§Ø¯ (Ù†Ø§ÙØ°Ø© DevTools)
  function checkDimensions() {
    try {
      const diffW = Math.abs(window.outerWidth - window.innerWidth);
      const diffH = Math.abs(window.outerHeight - window.innerHeight);
      detections.dimensionDiff =
        diffW > SETTINGS.widthDiffThreshold || diffH > SETTINGS.widthDiffThreshold;
    } catch (e) {}
  }

  // Ø·Ø±ÙŠÙ‚Ø© 3: ÙØ­Øµ ØªÙˆÙ‚Ù Ø§Ù„ØªÙ†ÙÙŠØ° (breakpoint)
  function checkIntervalPause() {
    const now = performance.now();
    const delta = now - lastTick;
    lastTick = now;
    detections.intervalPause = delta > (SETTINGS.pauseThreshold + SETTINGS.checkInterval);
  }

  // Ø·Ø±ÙŠÙ‚Ø© 4: ÙƒØ´Ù ØªÙ„Ø§Ø¹Ø¨ console
  (function consoleWrap() {
    const origConsole = window.console;
    const obj = {};
    try {
      Object.defineProperty(obj, "x", {
        get: function () {
          detections.consoleTamper = true;
          return "x";
        },
        configurable: true
      });
      origConsole.log(obj);
    } catch (e) {
      detections.consoleTamper = true;
    }
  })();

  function totalDetectionsCount() {
    return Object.values(detections).filter(Boolean).length;
  }

  function onDetect() {
    if (detected) return;
    detected = true;

    // Ø¥Ø®ÙØ§Ø¡ Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø­Ø³Ø§Ø³Ø©
    try {
      const nodes = document.querySelectorAll(SETTINGS.sensitiveSelector);
      nodes.forEach(n => {
        n.style.filter = "blur(8px) grayscale(60%)";
        n.style.pointerEvents = "none";
        n.style.userSelect = "none";
      });
    } catch (e) {}

    // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ù…Ù† Ø§Ù„Ø°Ø§ÙƒØ±Ø©
    if (window.__SENSITIVE_TOKEN) window.__SENSITIVE_TOKEN = null;
    if (window.__SESSION_SECRET) window.__SESSION_SECRET = null;

    window.__DEVTOOLS_DETECTED = true;

    // Ø¥Ø±Ø³Ø§Ù„ Ø¥Ø´Ø¹Ø§Ø± ØµØ§Ù…Øª Ù„Ù„Ø³ÙŠØ±ÙØ± (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)
    try {
      if (navigator.sendBeacon) {
        navigator.sendBeacon(SETTINGS.notifyEndpoint, JSON.stringify({
          url: location.href,
          ts: new Date().toISOString(),
          detections
        }));
      }
    } catch (e) {}
  }

  setInterval(() => {
    checkDimensions();
    checkIntervalPause();
    if (totalDetectionsCount() >= SETTINGS.requiredDetections) {
      onDetect();
    }
  }, SETTINGS.checkInterval);

  // Ø§Ø³ØªØ¨Ø¯Ù„ fetch Ø¨Ù€ safeFetch Ù„Ù…Ù†Ø¹ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø­Ø³Ø§Ø³Ø© Ø¨Ø¹Ø¯ Ø§Ù„ÙƒØ´Ù
  window.safeFetch = async function (url, opts) {
    if (window.__DEVTOOLS_DETECTED) {
      return Promise.reject(new Error("Blocked: devtools detected"));
    }
    return fetch(url, opts);
  };
})();
  </script>
</body>
</html>
