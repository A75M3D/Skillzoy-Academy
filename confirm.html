<!doctype html>
<html lang="ar">
<head>
  <script src="https://unpkg.com/@supabase/supabase-js"></script>
<script>
  const supabase = supabase.createClient(
    'https://sjipwstkvvrautexigmt.supabase.co',
    'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNqaXB3c3RrdnZyYXV0ZXhpZ210Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg5MTE5MDcsImV4cCI6MjA3NDQ4NzkwN30.FSh2yIdZdvdNvtWxK5JB02PIdWOG3707qO-F0c84PnY'                       // ← اكتب المفتاح العام هنا
  );
');
</script>
  <meta charset="utf-8">
  <title>تأكيد الحساب</title>
  <h1 style="color: blue">Skillzoy Academy</h1>
  <style>
    
      font-family: "Cairo", Arial, sans-serif;
      text-align: center;
      padding: 60px;
      background: #f9f9f9;
      color: #333;
    }
    .box {
      background: #fff;
      border-radius: 12px;
      padding: 40px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
      display: inline-block;
    }
    h2 { color: #4CAF50; }
    #countdown { font-weight: bold; color: #007BFF; }
  </style>
</head>
<body>
  <div class="box">
    <h2>✅ تم تأكيد حسابك بنجاح</h2>
    <p>سيتم تحويلك إلى صفحتك خلال <span id="countdown">3</span> ثوانٍ...</p>
  </div>
<script>


  // 2. نشوف إذا في رابط فيه كلمة "token" بعد #
  const hash = window.location.hash; // مثال: #token=abc123&type=email

  if (hash) {
    // 3. نستخرج الـ token من الرابط
    const params = new URLSearchParams(hash.substring(1)); // نزيل الـ #
    const token = params.get('token');

    // 4. إذا وجدنا token، نرسله لـ Supabase علشان يتأكد منه
    if (token) {
      supabase.auth.verifyOtp({
        token_hash: token,
        type: 'signup'
      }).then(({ data, error }) => {
        if (error) {
          alert('❌ خطأ: ' + error.message);
        } else {
          alert('✅ تم تفعيل حسابك!');
          // نمسح الـ token من الرابط بعد ما نخلص
          history.replaceState(null, null, ' ');
        }
      });
    }
  }
</scr>ipt
  <script>
    let timeLeft = 3;
    const countdownElem = document.getElementById("countdown");

    const timer = setInterval(() => {
      timeLeft--;
      countdownElem.innerText = timeLeft;
      if (timeLeft <= 0) {
        clearInterval(timer);
        // غير الرابط للصفحة اللي عايز المستخدم يروح ليها
        window.location.href = "https://skillzoy-academy.vercel.app/str.html"; 
      }
    }, 1000);
  </script>
</body>
</html>
